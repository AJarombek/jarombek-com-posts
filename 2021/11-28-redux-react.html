<div>
<Note type="info">
This is part of a series of articles on SaintsXCTF Version 2.0. The first article in the series provides an
<a href="https://jarombek.com/blog/jun-14-2021-saints-xctf-v2-overview">overview of the application</a>.  You
<strong>DO NOT</strong> need to read prior articles in the series to fully understand this article.
</Note>
<p>
Redux is a state management pattern that is commonly used in complex React applications.  Redux, based on the Flux
design pattern, is helpful when application state is shared between many pages of a website and is updated
frequently<sup>1</sup>.  In my <a href="https://saintsxctf.com/">saintsxctf.com</a> website, Redux is used to store
application state and use it across all the webpages.  SaintsXCTF is a good example of a website that can benefit from
Redux;  it needs login information, user preferences, team memberships, group memberships, and more to be shared
amongst all pages.
</p>
<p>
In this article, I start by going over the basics of Redux.  I’ll also explain the “ducks pattern”, which is an
approach to writing Redux code.  Then, I’ll walk through the Redux configuration and code in my SaintsXCTF
application.  All the code for my SaintsXCTF web application is available in a <a href="https://github.com/AJarombek/
saints-xctf-web">GitHub</a> repository.
</p>
<SubTitle title="SaintsXCTF Version 2.0 Articles">SaintsXCTF Version 2.0 Articles</SubTitle>
<ul>
<li><a href="https://jarombek.com/blog/jun-14-2021-saints-xctf-v2-overview">Architectural Overview</a></li>
<li><a href="https://jarombek.com/blog/jun-14-2021-saints-xctf-v2-overview">AWS Infrastructure</a></li>
<li><a href="https://jarombek.com/blog/oct-25-2021-saints-xctf-v2-k8s-infrastructure">Kubernetes Infrastructure</a></li>
<li><a href="https://jarombek.com/blog/nov-1-2021-saints-xctf-v2-react-web-app">React Web Application Overview</a></li>
<li><a href="https://jarombek.com/blog/nov-15-2021-react-typescript">Web Application React and TypeScript</a></li>
<li><strong>Web Application Redux State Configuration</strong></li>
<li>Web Application Cypress E2E Tests</li>
<li>Web Application JSS Modular Design</li>
<li>Flask Python API</li>
<li>Flask API Testing</li>
<li>Flask API Docker & Docker Compose Configuration</li>
<li>Function API Using API Gateway & Lambda</li>
<li>Auth API Using API Gateway & Lambda</li>
<li>Database Deployments Using Jenkins</li>
<li>Database Client on Kubernetes</li>
<li>IOS Application Updates and Learning Experiences</li>
<li>Testing and Continuous Deployment on Jenkins</li>
<li>Post-Deployment Challenges & Future Improvements</li>
</ul>
<SectionTitle title="Introduction to Redux">Introduction to Redux</SectionTitle>
<p>
Redux is an open-source JavaScript library based on the Flux design pattern.
</p>
<Definition word="Flux">
<p>
Flux is a web-development design pattern and architecture which is an alternative to the MVC (Model View Controller)
pattern<sup>2,3</sup>.  Flex maintains application state in one or many <strong>stores</strong>.  Stores are updated
with <strong>actions</strong>, which contain new state data and instructions for updating a store<sup>4</sup>.  Actions
are passed to stores via a <strong>dispatcher</strong>.  Once actions reach the store, the application state is updated
accordingly, and any views that use the application state are re-rendered.
</p>
<p>
Flux creates a unidirectional flow of data, beginning with an event on the UI, such as a button click. UI events
trigger actions, with travel through the dispatcher to a store. Finally, the UI updates according to the new state in
the store.  If you want to understand Flux in more detail, I recommend reading the official <a href="https://
facebook.github.io/flux/docs/in-depth-overview">In-Depth Overview</a>.
</p>
</Definition>
<Definition word="Redux">
<p>
Redux is based on the Flux design pattern with a few key differences.  Unlike Flux, Redux consists of a single store
containing an immutable state object.  Redux also does not have dispatchers.  Instead, Redux has
<strong>reducers</strong>.  Reducers are functions which take an action and the existing state as arguments.  During
the execution of a reducer function, a new state object is created and returned<sup>5</sup>.
</p>
<p>
Similar to Flux, Redux follows a unidirectional data flow.  Once again, actions are created when UI events occur.
Actions pass data to the store, the state in the store is updated with the help of a reducer, and the UI is updated
accordingly.
</p>
</Definition>
<p>
Let’s describe the main components of Redux in more detail.  These components include <strong>actions</strong>,
<strong>action creators</strong>, <strong>reducers</strong>, and <strong>the store</strong>.
</p>
<InlineImage filename="11-28-21-redux-components.png" paddingTop="true" paddingBottom="true">
</InlineImage>
<ComparisonTable title="Redux Components">
<ComparisonTableEntry>
<h5 className="jarombek-cte-title">
Actions
</h5>
<div className="jarombek-cte-body">
<p>
Actions are JavaScript objects which describe how to update the application state in the Redux store.  Action objects
have a <code className="jarombek-inline-code">type</code> field, which is a string that identifies the action.  Actions
often have additional fields with instructions on how to update the state or data to add to the state.  For example,
an action to sign in a user and place their username in the application state may look like
<code className="jarombek-inline-code">{type: "SIGN_IN", username: "andy"}</code>.
</p>
<p>
Actions are dispatched to the Redux store.  The Redux store invokes a reducer function corresponding to the
action.  This reducer returns a new application state with changes made, which are determined by the action.
</p>
</div>
</ComparisonTableEntry>
<ComparisonTableEntry>
<h5 className="jarombek-cte-title">
Action Creators
</h5>
<div className="jarombek-cte-body">
<p>
Action creators are functions that create Redux action objects.  They simplify the creation of actions by encapsulating
the logic for building an action of a specific type within a single function.  For example, the action
<code className="jarombek-inline-code">{type: "SIGN_IN", username: "andy"}</code> can be built from an action creator
<code className="jarombek-inline-code">signIn()</code> that takes a username as an argument.
</p>
<p>
Sometimes, action creators perform more complex logic, such as performing asynchronous operations to external services
and interfaces; for example, an action creator may invoke an API and create actions based on the response.
</p>
</div>
</ComparisonTableEntry>
<ComparisonTableEntry>
<h5 className="jarombek-cte-title">
Reducers
</h5>
<div className="jarombek-cte-body">
<p>
Reducers are functions that create new state objects.  Reducers take two arguments: an action object and an existing
state object.  The reducer creates a copy of the existing state object and applies changes specified in the action.
The return value of the reducer is the new state object, which replaces the existing state object in the Redux store.
</p>
</div>
</ComparisonTableEntry>
<ComparisonTableEntry>
<h5 className="jarombek-cte-title">
Store
</h5>
<div className="jarombek-cte-body">
<p>
Redux contains a single store, which holds the application state.  Application state is immutable, i.e. an application
state object cannot be modified.  To change the state in the store, a new state object replaces the entire existing
state object.  New state objects are created with the help of reducer functions.  Reducer functions are called when
actions are dispatched to the store.
</p>
</div>
</ComparisonTableEntry>
</ComparisonTable>
<p>
When using Redux in a React application, the <a href="https://react-redux.js.org/tutorials/quick-start">React Redux</a>
library is often used to simplify the configuration and usage of Redux.  I utilize React Redux in my SaintsXCTF
application.
</p>
<SectionTitle title="Ducks Pattern">Ducks Pattern</SectionTitle>
<p>
The <strong>ducks pattern</strong> relates to the file layout of Redux code.  In older applications, Redux code was
often grouped into separate directories for actions, reducers, and action creators<sup>6</sup>.  With the ducks
pattern, actions, reducers, and action creators exist in the same files.  However, code is logically grouped in
separate files.
</p>
<p>
For example, my SaintsXCTF application has a <a href="https://github.com/AJarombek/saints-xctf-web/tree/master/src/
redux/modules">redux/modules</a> directory which contains all my Redux TypeScript files which follow the ducks
pattern.  Each file in this directory relates to a specific feature of the application.  The <a href="https://
github.com/AJarombek/saints-xctf-web/blob/master/src/redux/modules/groups.ts">groups.ts</a> file, for example, contains
actions, reducers, and action creators that relate to group pages on the website (user’s in SaintsXCTF can be members
of one or many groups).
</p>
<p>
The following code snippet is an abbreviated version of <strong>groups.ts</strong>:
</p>
<CodeSnippet language="TypeScript">
// groups.ts

// Actions
const GET_GROUP_REQUEST = 'saints-xctf-web/groups/GET_GROUP_REQUEST';
...

// Action Types
interface GetGroupRequestAction {
  type: typeof GET_GROUP_REQUEST;
  groupId: number;
}

...

// Reducers
function getGroupRequestReducer(state: GroupState, action: GetGroupRequestAction): GroupState {
  const existingGroupState = state.group[action.groupId] ?? {};

  return {
    ...state,
    group: {
      ...state.group,
      [action.groupId]: {
        ...existingGroupState,
        isFetching: true,
        lastUpdated: moment().unix(),
        serverError: null
      }
    }
  };
}

...

export default function reducer(state = initialState, action: GroupActionTypes): GroupState {
  switch (action.type) {
    case GET_GROUP_REQUEST:
      return getGroupRequestReducer(state, action);
    ...
    default:
      return state;
  }
}

// Action Creators
export function getGroupRequest(groupId: number): GetGroupRequestAction {
  return {
    type: GET_GROUP_REQUEST,
    groupId
  };
}

...
</CodeSnippet>
<SectionTitle title="Redux Application Setup">Redux Application Setup</SectionTitle>
<p>
Redux is configured with the React application using the <a href="https://react-redux.js.org/tutorials/quick-start">
React Redux</a> library.  Both <code className="jarombek-inline-code">react-redux</code> and
<code className="jarombek-inline-code">@types/react-redux</code> are specified as dependencies to the application in
the <a href="https://github.com/AJarombek/saints-xctf-web/blob/master/package.json">package.json</a> file.  The
configuration of Redux begins in the entrypoint of the React application, <a href="https://github.com/AJarombek/
saints-xctf-web/blob/master/src/index.tsx#L35-L48">index.ts</a>.
</p>
<SectionTitle title="Redux State Management Code">Redux State Management Code</SectionTitle>
<SectionTitle title="Conclusions">Conclusions</SectionTitle>
</div>